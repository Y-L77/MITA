<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MITA — Notify Me</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-dark: #0c0c0c;
      --card-bg: #121212;
      --border-color: rgba(255, 255, 255, 0.06);
      --muted: #a7a7a7;
      --input-bg: #1a1a1a;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Courier New', monospace; }
    body {
      background: var(--bg-dark); color: #fff; display: flex; align-items: center; justify-content: center;
      min-height: 100dvh; -webkit-font-smoothing: antialiased;
    }
    .wrap { display: flex; align-items: center; justify-content: center; width: 100%; padding: 16px; }
    .card {
      width: clamp(320px, 90vw, 420px); background: var(--card-bg);
      border: 1px solid var(--border-color); border-radius: 16px;
      box-shadow: 0 20px 64px rgba(0, 0, 0, 0.55);
      padding: 32px 28px; display: flex; flex-direction: column; gap: 20px; text-align: center;
    }
    .logo {
      width: 48px; height: 48px; border-radius: 12px; background: #fff; color: #000;
      display: grid; place-items: center; font-weight: 800; font-size: 1.2rem; margin: 0 auto;
    }
    h1 { font-size: 1.35rem; font-weight: 600; line-height: 1.3; color: #fff; }
    .muted { color: var(--muted); font-size: 0.9rem; }
    input[type="email"] {
      width: 100%; padding: 0.8rem 1rem; border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.08); background-color: var(--input-bg);
      color: white; margin-top: 0.5rem; font-size: 1rem; transition: border-color 0.2s ease;
    }
    input[type="email"]:focus { outline: none; border-color: rgba(255,255,255,0.2); }
    button {
      width: 100%; padding: 0.9rem 1rem; background-color: white; color: black;
      border: none; border-radius: 10px; font-weight: 600; cursor: pointer;
      transition: background-color 0.25s ease, transform 0.1s ease; margin-top: 8px;
    }
    button:hover { background-color: #e5e5e5; transform: translateY(-1px); }
    .success { color: #4ade80; font-weight: 500; font-size: 1rem; }
    .error { color: #f87171; font-weight: 500; font-size: 0.95rem; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="logo">M</div>
      <div>
        <h1>MITA — Mathematical International Talent Arena</h1>
        <p class="muted">Sign up to get notified about MITA updates and early access.</p>
      </div>

      <!-- ✅ FORM (uses hidden iframe to bypass CORS) -->
      <form
        id="emailForm"
        action="https://script.google.com/macros/s/AKfycbzmmBCiQGQR6q2EfFewX3mggYlL-t-jnWjnPQEDlDsaJf4rJVjBwJBEPyi4pP4Rn0v2/exec"
        method="POST"
        target="hiddenFrame"
        novalidate
      >
        <input
          type="email"
          name="email"
          id="email"
          placeholder="Enter your email"
          required
          autocomplete="email"
          inputmode="email"
          pattern="^[^\s@]+@[^\s@]+\.[^\s@]{2,}$"
          aria-invalid="false"
          aria-describedby="errorMessage"
        />
        <button type="submit">Notify Me</button>
      </form>

      <!-- hidden iframe to receive form submission -->
      <iframe name="hiddenFrame" style="display:none;"></iframe>

      <p id="successMessage" class="success" style="display:none;">
        ✅ Thanks! You’ve been added.
      </p>
      <p id="errorMessage" class="error" style="display:none;">
        Please enter a valid email address (e.g., name@example.com).
      </p>
    </div>
  </div>

  <script>
    const form = document.getElementById("emailForm");
    const emailInput = document.getElementById("email");
    const successMessage = document.getElementById("successMessage");
    const errorMessage = document.getElementById("errorMessage");

    const isValidEmail = (value) => {
      const trimmed = value.trim();
      // Simple, robust email validation (user@domain.tld with 2+ char TLD)
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;
      return re.test(trimmed);
    };

    // Live validation feedback
    emailInput.addEventListener("input", () => {
      const val = emailInput.value;
      const ok = isValidEmail(val);

      // Set custom validity for consistent behavior across browsers
      emailInput.setCustomValidity(ok ? "" : "Invalid email address.");
      emailInput.setAttribute("aria-invalid", ok ? "false" : "true");

      // Toggle error message visibility
      if (val.length === 0 || ok) {
        errorMessage.style.display = "none";
      } else {
        errorMessage.style.display = "block";
      }
    });

    form.addEventListener("submit", (e) => {
      const val = emailInput.value.trim();

      // Final guard before submit
      if (!isValidEmail(val)) {
        e.preventDefault();
        errorMessage.style.display = "block";
        emailInput.reportValidity(); // shows native tooltip if available
        return;
      }

      // instantly show success message (unchanged behavior)
      form.style.display = "none";
      successMessage.style.display = "block";
    });
  </script>
</body>
</html>
